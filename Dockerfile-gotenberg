# Use the latest official Gotenberg image as base (includes LibreOffice, Chromium, Carlito, etc.)
FROM gotenberg/gotenberg:8

# Switch to root to install packages
USER root

# Accept Microsoft EULA automatically and install core fonts
# Also refresh font cache
RUN echo "ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true" | debconf-set-selections && \
    apt-get update && \
    apt-get install -y --no-install-recommends ttf-mscorefonts-installer fontconfig && \
    fc-cache -fv && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Switch back to the default non-root user for security
USER gotenberg
